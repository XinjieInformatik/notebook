# Mechanisms of Action (MoA) Prediction
2020.12.01
https://www.kaggle.com/c/lish-moa/overview
- 特征：一个实验下，800+维度的gene特征与100维度cell特征
- 目标：输出206个MoA（药理作用）的置信度 - 预测当前药物该实验下，基因与细胞表现下是否有该药理作用 - 多任务分类问题

## 我的方案
因为数据量小，神经网络容易过拟合，而且目标稀疏，所以把神经网络当作随机森林用，每个单一模型使用5-10个fold stratification， 5个seed，每个seed的fold的shuffle规律不同。
在两个不同的分布下（不同的CV，stratification），分别训练4-6个NN模型，然后使用不同的方法blending。

### 单纯stratification的CV下训练的5个NN

| index | model   | CV       | CV ord. | public  | pb ord. | private | pv ord. |
| ----- | ------- | -------- | ------- | ------- | ------- | ------- | ------- |
| 1-1   | nn_base | 0.014533 | 4       | 0.01834 | 2       | 0.01626 | 2       |
| 1-2   | resnet  | 0.014480 | 3       | 0.01852 | 5       | 0.01634 | 5       |
| 1-3   | nn_no   | 0.014282 | 1       | 0.01838 | 3       | 0.01632 | 4       |
| 1-4   | drug_id | 0.014369 | 2       | 0.01826 | 1       | 0.01623 | 1       |
| 1-5   | tabnet  | 0.014866 | 5       | 0.01839 | 4       | 0.01629 | 3       |

### 结合drug种类做的CV下训练的6个NN

| index | model      | CV       | CV ord. | public  | pb ord. | private | pv ord. |
| ----- | ---------- | -------- | ------- | ------- | ------- | ------- | ------- |
| 2-1   | drug_id    | 0.015626 | 2       | 0.01837 | 3       | 0.01627 | 3       |
| 2-2   | nn_v3      | 0.015620 | 1       | 0.01833 | 1       | 0.01624 | 2       |
| 2-3   | nn_no_drug | 0.015642 | 3       | 0.01833 | 1       | 0.01623 | 1       |
| 2-4   | resnet     | 0.015790 | 5       | 0.01862 | 6       | 0.01644 | 6       |
| 2-5   | tabnet     | 0.015685 | 6       | 0.01842 | 5       | 0.01633 | 5       |
| 2-6   | nn_base    | 0.015654 | 4       | 0.01840 | 4       | 0.01627 | 3       |

### 模型融合
| index | 策略                           | CV       | public  | private |
| ----- | ------------------------------ | -------- | ------- | ------- |
| 1     | 加权融合 2-1 2-3               | 0.015516 | 0.01615 | 0.01823 |
| 2     | 2-1 2-3 206-target中选取最小CV | 0.015476 | 0.01619 | 0.01825 |
|       |                                |          |         |         |
