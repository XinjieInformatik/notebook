# 单例模式

保证一个类只有一个实例， 并提供一个访问该实例的全局节点。
单例模式对内存友好，但使用不灵活，避免滥用。

## 简单例子
```python
class ResourceManager(object):
    __resource = None
    __init_flag = False

    def __new__(cls, *args, **kwargs):
        # 全局只new一次
        if cls.__resource is None:
            cls.__resource = super().__new__(cls)
        
        return cls.__resource

    def __init__(self, param1, param2) -> None:
        # 全局只初始化一次
        if not self.__init_flag:
            self.param1 = param1
            self.param2 = param2
            self.__init_flag = True
```

## 简单例子 + 进程lock
```python
import threading
class ResourceManagerLock(object):
    __resource = None
    __init_flag = False
    _lock = threading.Lock()

    def __new__(cls, *args, **kwargs):
        with cls._lock:
            if cls.__resource is None:
                cls.__resource = super().__new__(cls)
        
        return cls.__resource

    def __init__(self, param1, param2) -> None:
        if not self.__init_flag:
            self.param1 = param1
            self.param2 = param2
            self.__init_flag = True


if __name__ == "__main__":
    aobj = ResourceManagerLock(param1=1, param2=2)
    print(aobj, aobj.param1, aobj.param2)
    bobj = ResourceManagerLock(param1=2, param2=3)
    print(bobj, bobj.param1, bobj.param2)
```
